<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>簡易輸入介面</title>
</head>
<body>
  <h2>操作面板</h2>

  <button onclick="sendMessage('問候')">問候</button>
  <button onclick="sendMessage('回報問題')">回報問題</button>
  <button onclick="sendMessage('其他')">其他</button>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxT_ATKmrq6F-rPOGiR8TwxmtpMMD-EWM_yt5NSqN_EWPJC2RtRUHMDTfNTwl1cphoI/exec";;

    function sendMessage(action) {
      const message = prompt(`請輸入「${action}」的訊息：`);
      if (message) {
        const formData = new URLSearchParams();
        formData.append("action", action);
        formData.append("message", message);
    
        fetch(scriptURL, {
          method: 'POST',
          body: new URLSearchParams({ action, message }),
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
        })
        .then(res => {
          if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
          return res.json();
        })
        .then(data => {
          alert("訊息已送出！");
          console.log("回應資料:", data);
        })
        .catch(err => {
          alert("發送失敗：" + err.message);
          console.error(err);
        });
      }
    }
  </script>
</body>
</html>
